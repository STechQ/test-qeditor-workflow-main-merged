/*! For license information please see humantask_design.js.LICENSE.txt */
!function(e,a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],a):"object"==typeof exports?exports.flowcomponent=a(require("react"),require("react-dom")):e.flowcomponent=a(e.react,e["react-dom"])}(this,((e,a)=>(()=>{var n={4645:(e,a,n)=>{"use strict";var l=n(7111);l.createRoot,l.hydrateRoot},6094:(e,a,n)=>{"use strict";var l=n(8156),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function c(e,a,n){var l,s={},c=null,p=null;for(l in void 0!==n&&(c=""+n),void 0!==a.key&&(c=""+a.key),void 0!==a.ref&&(p=a.ref),a)o.call(a,l)&&!r.hasOwnProperty(l)&&(s[l]=a[l]);if(e&&e.defaultProps)for(l in a=e.defaultProps)void 0===s[l]&&(s[l]=a[l]);return{$$typeof:t,type:e,key:c,ref:p,props:s,_owner:i.current}}a.Fragment=s,a.jsx=c,a.jsxs=c},4512:(e,a,n)=>{"use strict";e.exports=n(6094)},8156:a=>{"use strict";a.exports=e},7111:e=>{"use strict";e.exports=a},5685:(e,a)=>{var n;!function(){"use strict";var l={}.hasOwnProperty;function t(){for(var e="",a=0;a<arguments.length;a++){var n=arguments[a];n&&(e=o(e,s(n)))}return e}function s(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return t.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var a="";for(var n in e)l.call(e,n)&&e[n]&&(a=o(a,n));return a}function o(e,a){return a?e?e+" "+a:e+a:e}e.exports?(t.default=t,e.exports=t):void 0===(n=function(){return t}.apply(a,[]))||(e.exports=n)}()}},l={};function t(e){var a=l[e];if(void 0!==a)return a.exports;var s=l[e]={exports:{}};return n[e](s,s.exports,t),s.exports}t.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},t.d=(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.p="";var s={};return(()=>{"use strict";t.r(s),t.d(s,{default:()=>_});var e=t(4512),a=t(8156);const n={"":"Custom",inProgress:"In Progress",waitForApproval:"Waiting for Approval",completed:"Completed",new:"New",returned:"Returned",cancelled:"Cancelled",waitForControl:"Waiting for Control"},l={"--days-- Weekdays":"--days-- Weekdays","--days-- Calendar Days":"--days-- Calendar Days","--dd--":"--dd--","At The End Of The Month":"At The End Of The Month"},o={None:"None",Previous:"Previous",Next:"Next"},i={"--hours-- Hours":"--hours-- Hours","--hh--":"--hh--"},r={"--minutes-- Minutes":"--minutes-- Minutes","--mm--":"--mm--"},c={label:"",day:{type:"--days-- Weekdays",dayCorrection:"None",setTo:0},hour:{type:"--hours-- Hours",setTo:0},minute:{type:"--minutes-- Minutes",setTo:0}};function p(){return structuredClone(c)}function u(e){if(!(e&&e.day&&e.hour&&e.minute))return e=structuredClone(c),"";if("At The End Of The Month"===e.day.type){if(e.day.setTo=0,"--hh--"!==e.hour.type&&"--mm--"!==e.minute.type)return"Hour and minute must be set as hh:mm"}else if(0!==e.day.setTo){if(!e.day.type||!Object.keys(l).includes(e.day.type))return"Day Setting Type Not Set Properly";if("--dd--"===e.day.type&&"--hh--"!==e.hour.type&&"--mm--"!==e.minute.type)return"Hour and minute must be set as hh:mm"}return"--hh--"===e.hour.type&&"--mm--"!==e.minute.type||"--hh--"!==e.hour.type&&"--mm--"===e.minute.type?"Hour and Minute types must be aligned":""}t.p,t.p;const d=({label:n,isKeepOpen:l=!1,onAddButton:t,children:s})=>{const[o,i]=(0,a.useState)(!0);return(0,e.jsxs)("div",{className:"variables ",children:[(0,e.jsxs)("div",{className:"d-flex justify-content-between p-3 pb-0",children:[(0,e.jsxs)("div",{className:"d-flex cursor-pointer",onClick:()=>i(!o),children:[!l&&(0,e.jsx)("i",{className:"mdi "+(o?"mdi-chevron-down":"mdi-chevron-right")}),(0,e.jsx)("p",{children:n})]}),t&&(0,e.jsx)("i",{className:"mdi mdi-plus cursor-pointer",onClick:e=>{e.preventDefault(),e.stopPropagation(),t(e)}})]}),(l||o)&&(0,e.jsx)("ul",{className:"variable-list",children:s})]})};var m=t(5685),v=t.n(m);t.p;const y=({isOpen:n,onClose:l,children:t,footer:s=[],title:o,type:i="dialog",position:r})=>{if(!n)return null;const[c,p]=(0,a.useState)({top:0}),u=(0,a.useRef)(null);return(0,a.useEffect)((()=>{var e,a;if(r){const n=window.innerHeight>r.top+((null===(e=u.current)||void 0===e?void 0:e.clientHeight)||0)?r.top:window.innerHeight-((null===(a=u.current)||void 0===a?void 0:a.clientHeight)||0)-10;p({top:n})}}),[r]),(0,e.jsx)("div",{className:v()({overlay:"modal"===i}),children:(0,e.jsxs)("div",{ref:u,className:v()("dialog",{"dialog-monaco":"modal"==i}),style:c,children:["dialog"===i?(0,e.jsxs)("div",{className:"dots",style:{cursor:"grab"},onMouseDown:e=>(e=>{e.preventDefault();const a=u.current;if(!a)return;const n=a.getBoundingClientRect(),l=e.clientX-n.left,t=e=>{p({top:e.clientY-10,left:e.clientX-l})},s=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",s)})(e),children:[(0,e.jsx)("span",{}),(0,e.jsx)("span",{}),(0,e.jsx)("span",{})]}):(0,e.jsx)("div",{}),(0,e.jsxs)("div",{className:"dialog-header",children:[(0,e.jsx)("h5",{className:"dialog-title m-0",children:o}),(0,e.jsx)("div",{className:"cursor-pointer",onClick:l,children:(0,e.jsx)("i",{className:"mdi mdi-window-close"})})]}),(0,e.jsx)("div",{className:"dialog-body",children:t}),s.length>0&&(0,e.jsx)("div",{className:"dialog-footer",children:s.map((e=>e))})]})})};function f(e,n){(0,a.useEffect)((()=>{const a=a=>{const l=null==e?void 0:e.current;l&&!l.contains((null==a?void 0:a.target)||null)&&n(a)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}}),[e,n])}t.p;const h=n=>{var l;const[t,s]=(0,a.useState)(!1),o=(0,a.useRef)(null);return f(o,(()=>s(!1))),(0,e.jsxs)("div",{className:"dropdown-flow",ref:o,children:[(0,e.jsx)("button",{className:"cursor-pointer",onClick:e=>{e.stopPropagation(),s(!t)},children:n.iconClass&&(0,e.jsx)("i",{className:n.iconClass})}),(0,e.jsx)("ul",{className:"py-3",style:{display:t?"block":"none"},children:null===(l=n.options)||void 0===l?void 0:l.map((a=>(0,e.jsx)("li",{className:"px-3 py-1 cursor-pointer ellipsis-text",onClick:e=>{s(!1),a.onClick(e)},children:a.name},a.name)))})]})},g=({collapsibleLabel:n,fields:l,disabledFields:t=[],fieldLabel:s,dialogElements:o,emptyValues:i,isAddible:r=!0,isDeletable:c=!0,isCollabsible:p=!0,createItemLabel:u,dialogTitle:m,maxItemLen:v,disabled:f,onChange:g,validate:b,getFieldLabel:x})=>{const[j,N]=(0,a.useState)([]),[k,S]=(0,a.useState)(!1),[C,w]=(0,a.useState)(0),[T,E]=(0,a.useState)({top:0}),[O,P]=(0,a.useState)(!1),[M,A]=(0,a.useState)("");(0,a.useEffect)((()=>{const e=new Set(t.map((e=>JSON.stringify(e)))),a=l.filter((a=>!e.has(JSON.stringify(a))));N(a)}),[l]);const L=(e,a,n=!1)=>{E({top:e.pageY}),P(n),w(a),b&&A(b(j[a])),S(!0)},R=(e,a,n=s)=>{if(!e)return;if(n.includes(".")){const a=V(n,e);return Array.isArray(a)||"object"!=typeof a?a:a.value?`${a.type}.${a.value}`:`${"name"==s?"Variable ":s}`}const l=e?e[n]:e;return Array.isArray(l)||"object"!=typeof l?l:l.value?`${l.type}.${l.value}`:`${"name"==s?"Variable ":s}`},V=(e,a)=>{if(a)return e.split(".").reduce(((e,a)=>e[a]),a)},$=e=>{N(e),g(JSON.parse(JSON.stringify([...t,...e])))};function D(e,a){const n=[...j];((e,a,n)=>{const l=a.split("."),t=l.pop();l.reduce(((e,a)=>e[a]),e)[t]=n})(n[C],e,a),$(n),b&&A(b(n[C]))}const I=e=>{if(f)return;if(void 0!==v&&j.length>=v)return;const a=[...j],n=JSON.parse(JSON.stringify(i));Object.keys(n).forEach((e=>{if("name"==e)n[e]=""==n[e]?`Variable ${(a.length+1).toString()}`:n[e];else if("object"==typeof n[e]&&n[e].hasOwnProperty("value")){let l=n[e].value;l=""==l?s+" "+(a.length+1).toString():l,n[e].value=l}})),a.push(n),$(a),e&&E({top:e.pageY}),w(a.indexOf(n)),S(!0)},F=(e,a)=>{var n;const l={true:t,false:j};f&&(l[O.toString()]={...t,...j});const s=null===(n=l[O.toString()])||void 0===n?void 0:n[C];return{Expression:{expression:(null==s?void 0:s[a])||{type:"string",value:""},onBlur:e=>{D(a,e)}},Checkbox:{checked:R(s,0,a)||!1,onChange:e=>{D(a,e)}},Select:{value:R(s,0,a)||"",onChange:e=>{D(a,e)}},Input:{value:R(s,0,a)||"",onChange:e=>{D(a,e)}},MultiSelect:{values:R(s,0,a)||[],onChange:e=>{D(a,e)}},Mapping:{mapping:V(a,s)||{inParamMapping:{},outParamMapping:{}},onChangeInParamMapping:e=>{D(a+".inParamMapping",e)},onChangeOutParamMapping:e=>{D(a+".outParamMapping",e)}}}[e]||{value:(null==s?void 0:s[a])||"",onChange:e=>{D(a,e)}}};return(0,e.jsx)(e.Fragment,{children:0==(null==j?void 0:j.length)&&0==t.length&&r?(0,e.jsxs)("div",{className:"dynamic-field-create vertical-line cursor-pointer",onClick:e=>I(e),children:[(0,e.jsx)("p",{children:u}),void 0===v||void 0!==v&&j.length<v?(0,e.jsx)("i",{className:"mdi mdi-plus"}):(0,e.jsx)(e.Fragment,{})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(d,{label:n,isKeepOpen:!p,...(()=>{if(r&&!(void 0!==v&&j.length>=v))return{onAddButton:I}})(),children:[null==t?void 0:t.map(((a,n)=>(0,e.jsx)("li",{className:`d-flex justify-content-between align-items-center px-1 py-2 cursor-pointer ${j.length-1!==n&&"vertical-line"}`,onClick:e=>L(e,n,!0),children:(0,e.jsx)("p",{className:"m-0 ellipsis-text",children:(null==x?void 0:x(a))||R(a)||`${"name"==s?"Variable ":s} ${n+1}`})},`item${n}`))),null==j?void 0:j.map(((a,n)=>(0,e.jsxs)("li",{className:`d-flex justify-content-between align-items-center px-1 py-2 cursor-pointer ${j.length-1!==n&&"vertical-line"}`,onClick:e=>L(e,n,f),children:[(0,e.jsx)("p",{className:"m-0 ellipsis-text",children:(null==x?void 0:x(a))||R(a)||`${"name"==s?"Variable ":s} ${n+1}`}),c&&(0,e.jsx)(h,{iconClass:"mdi mdi-dots-horizontal",options:[{name:"Delete",onClick:e=>{((e,a)=>{e.preventDefault(),e.stopPropagation(),$([...j].filter(((e,n)=>n!=a))),S(!1)})(e,n)}}]})]},`item${n}`)))]}),(0,e.jsxs)(y,{isOpen:k,title:m,onClose:()=>(S(!1),void A("")),position:T,children:[(0,e.jsxs)("p",{style:{color:"red",display:""===M?"none":""},children:["$",M]}),o.map(((a,n)=>{var l,s;if((O||!a.isRendered||(null===(l=null==a?void 0:a.isRendered)||void 0===l?void 0:l.call(a,j[C])))&&(!O||!a.isRendered||(null===(s=null==a?void 0:a.isRendered)||void 0===s?void 0:s.call(a,t[C]))))return(0,e.jsx)(a.component,{...F(a.componentName,a.key),disabled:O,...a.props,children:a.children},a.key)}))]})]})})};function b(e){return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}function x(e){const n=(0,a.useSyncExternalStore)(b,(()=>function(e){var a,n,l,t,s;const o=null===(a=e.current)||void 0===a?void 0:a.getBoundingClientRect();return JSON.stringify({width:null!==(n=null==o?void 0:o.width)&&void 0!==n?n:0,height:null!==(l=null==o?void 0:o.height)&&void 0!==l?l:0,top:null!==(t=null==o?void 0:o.top)&&void 0!==t?t:0,left:null!==(s=null==o?void 0:o.left)&&void 0!==s?s:0})}(e)));return(0,a.useMemo)((()=>JSON.parse(n)),[n])}t.p;const j=({label:n,options:l=[],className:t,placeholder:s,value:o,disabled:i,onChange:r})=>{const[c,p]=(0,a.useState)(!1),[u,d]=(0,a.useState)(o),[m,v]=(0,a.useState)([]),y=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(null),{width:b,top:j,left:N,height:k}=x(h),{height:S}=x(g);return f(y,(()=>p(!1))),(0,a.useEffect)((()=>{const e=m.find((e=>e.value===o));e?d(e.name):o||d("")}),[o,m]),(0,a.useEffect)((()=>{v(l)}),[l]),(0,e.jsxs)("div",{className:`select-flow position-relative ${t||""}`,children:[n&&(0,e.jsx)("label",{className:"d-block ellipsis-text p-0",children:n}),(0,e.jsxs)("div",{ref:y,children:[(0,e.jsxs)("div",{className:"input",ref:h,onClick:()=>{i||p(!c)},style:{cursor:i?"not-allowed":"default",opacity:i?"0.6":"1"},children:[(0,e.jsx)("input",{className:"w-100 ellipsis-text",placeholder:s,value:u,onChange:()=>{}}),(0,e.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,e.jsx)("div",{className:"options",ref:g,style:{display:c?"block":"none",pointerEvents:i?"none":"all",...(()=>{const e=window.innerHeight;return j+k+5+S>e?{top:j-S-5,left:N,width:b}:{top:j+k+5,left:N,width:b}})()},children:(0,e.jsx)("ul",{children:l.map((a=>(0,e.jsx)("li",{className:"cursor-pointer ellipsis-text",onClick:()=>a.value!=u?(e=>{r(e.value),p(!1)})(a):p(!1),children:a.name},a.value)))})})]})]})},N=(t.p,({label:n,className:l,placeholder:t,value:s,disabled:o,isDigit:i=!1,onChange:r,onBlur:c})=>{const[p,u]=(0,a.useState)(s);return(0,a.useEffect)((()=>{u(s)}),[s]),(0,e.jsxs)("div",{className:`input-flow ${l||""}`,children:[n&&(0,e.jsx)("label",{className:"d-block p-0",children:n}),(0,e.jsx)("input",{className:"w-100",placeholder:t,value:p,onChange:e=>{const a=e.target.value;i&&!new RegExp(/^\d+$/).test(a)||(null==r||r(a),u(a))},onBlur:c,disabled:o})]})}),k={start:"start",complete:"complete",cancel:"cancel",return:"return",claim:"claim",unclaim:"unclaim",assignToUser:"assignToUser",assignToUnit:"assignToUnit",save:"save",function:"function",trigger:"trigger"},S=["start","claim","assignToUser","assignToUnit"],C=n=>{var t,s,c;const m=Object.keys(l).map((e=>({name:e,value:e}))),v=Object.keys(o).map((e=>({name:e,value:e}))),y=Object.keys(i).map((e=>({name:e,value:e}))),f=Object.keys(r).map((e=>({name:e,value:e}))),h={...p(),label:"SLA Goal"},b={...p(),label:"SLA Deadline"},x={...p(),label:"SLA Critical"},[k,S]=(0,a.useState)(n.priority||10),[C,w]=(0,a.useState)([(null===(t=n.sla)||void 0===t?void 0:t.slaGoal)||h,(null===(s=n.sla)||void 0===s?void 0:s.slaDeadline)||b,(null===(c=n.sla)||void 0===c?void 0:c.slaCritical)||x]);(0,a.useEffect)((()=>{S(n.priority||10)}),[n.priority]),(0,a.useEffect)((()=>{var e,a,l;w([(null===(e=n.sla)||void 0===e?void 0:e.slaGoal)||h,(null===(a=n.sla)||void 0===a?void 0:a.slaDeadline)||b,(null===(l=n.sla)||void 0===l?void 0:l.slaCritical)||x])}),[n.sla]);const T=[{component:j,componentName:"Select",key:"day.type",props:{label:"Day Calculation Type",options:m,className:"mt-3"}},{component:j,componentName:"Select",key:"day.dayCorrection",isRendered:e=>{var a;return"--days-- Weekdays"!==(null===(a=null==e?void 0:e.day)||void 0===a?void 0:a.type)||!1},props:{label:"Weekday Correction",options:v,className:"mt-3"}},{component:N,componentName:"Input",key:"day.setTo",isRendered:e=>{var a;return"At The End Of The Month"!==(null===(a=null==e?void 0:e.day)||void 0===a?void 0:a.type)||!1},props:{label:"Day",isDigit:!0}},{component:j,componentName:"Select",key:"hour.type",props:{label:"Hour Calculation Type",options:y,className:"mt-3"}},{component:N,componentName:"Input",key:"hour.setTo",props:{label:"Hour",isDigit:!0}},{component:j,componentName:"Select",key:"minute.type",props:{label:"Minute Calculation Type",options:f,className:"mt-3"}},{component:N,componentName:"Input",key:"minute.setTo",props:{label:"Minute",isDigit:!0}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(d,{label:"PRIORITY",children:(0,e.jsx)(N,{disabled:n.readOnly,className:"w-100",placeholder:"10",isDigit:!0,value:k.toFixed(0),onChange:e=>{const a=Number(e);S(a),n.onChangePriority(a)}})}),(0,e.jsx)(g,{disabled:n.readOnly,emptyValues:p(),dialogTitle:"Time Setting",fields:C,fieldLabel:"label",collapsibleLabel:"SLA",dialogElements:T,isAddible:!1,isDeletable:!1,onChange:e=>{var a;a=e,n.onChangeSLA({slaGoal:a[0],slaDeadline:a[1],slaCritical:a[2]})},validate:u})]})},w=(t.p,({label:a,className:n,checked:l,disabled:t,onChange:s})=>(0,e.jsxs)("div",{className:`checkbox-flow ${n||""}`,children:[(0,e.jsx)("input",{className:"cursor-pointer m-0",type:"checkbox",checked:l,onChange:e=>(s(e.target.checked),e.target.checked),disabled:t}),(0,e.jsx)("label",{className:"p-0",children:a})]})),T=(t.p,({id:a,label:n,remove:l})=>(0,e.jsxs)("div",{className:"tag",children:[(0,e.jsx)("label",{children:n}),(0,e.jsx)("i",{className:"mdi mdi-close cursor-pointer",onClick:()=>{l(a)}})]})),E=({label:n,options:l,className:t,placeholder:s,values:o,disabled:i,onChange:r})=>{const[c,p]=(0,a.useState)(!1),[u,d]=(0,a.useState)([]),m=(0,a.useRef)(null),v=(0,a.useRef)(null),y=(0,a.useRef)(null),{width:h,top:g,left:b,height:j}=x(v),{height:N}=x(y);return(0,a.useEffect)((()=>{const e=l.filter((e=>null==o?void 0:o.some((a=>e.value===a))));e&&d(e)}),[o]),f(m,(()=>p(!1))),(0,e.jsxs)("div",{className:`select-flow position-relative ${t||""}`,children:[n&&(0,e.jsx)("label",{className:"d-block",children:n}),(0,e.jsxs)("div",{ref:m,children:[(0,e.jsxs)("div",{className:"input w-100",ref:v,onClick:e=>{e.preventDefault(),e.stopPropagation(),i||p(!c)},children:[(0,e.jsx)("div",{className:"w-100 input-block",children:u.map(((a,n)=>(0,e.jsx)(T,{id:n,remove:e=>{(e=>{const a=u.filter(((a,n)=>n!==e));d(a),r(a.map((e=>e.value)))})(e)},label:a.name},`tag_${n}`)))}),(0,e.jsx)("i",{className:"mdi mdi-chevron-down"})]}),(0,e.jsx)("div",{className:"options",ref:y,style:{display:c?"block":"none",...(()=>{const e=window.innerHeight;return g+j+5+N>e?{top:g-N-5,left:b,width:h}:{top:g+j+5,left:b,width:h}})()},children:(0,e.jsx)("ul",{children:l.map(((a,n)=>(0,e.jsx)("li",{className:"cursor-pointer",onClick:()=>(e=>{let a=u;u.some((a=>a.value===e.value))?a=u.filter((a=>a.value!==e.value)):a.push(e),d(a),r(a.map((e=>e.value)))})(a),children:(0,e.jsx)(w,{checked:u.some((e=>e.value===a.value)),onChange:()=>{},label:a.name})},a.value)))})})]})]})};function O(e,a){return e?((e||[]).forEach((e=>{let n=[];e.roles.forEach((e=>{let l=null==a?void 0:a.find((a=>a.name.value===e||a.id===e));l&&n.push(l.id)})),e.roles=n})),e):[]}t.p,t(4645),t.p;const P=({children:a,className:n,color:l="primary",disabled:t,onClick:s})=>(0,e.jsx)("button",{className:v()("button-flow",n,l),disabled:t,onClick:s,children:a});t.p;const M=({node:n,level:l=0,onSelect:t,selected:s})=>{const[o,i]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const e=s.split(".");e.length>0&&i(o.concat(e))}),[s]),(0,e.jsx)("div",{className:"tree-node",children:Object.keys(n).map((a=>{const r=Array.isArray(n[a])?n[a].length>0:"object"==typeof n[a]&&null!==n[a],c=s===a,p=s.split(".").length>1?s.split(".").filter(((e,a)=>0!==a)).join("."):s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:v()("tree-row",{selected:c}),onClick:()=>(e=>{t(e)})(a),children:(0,e.jsxs)("div",{className:"tree-text",style:{paddingLeft:r?20*l:20*l+10},onClick:()=>(e=>{o.includes(e)?i(o.filter((a=>a!==e))):i([...o,e])})(a),children:[r&&(0,e.jsx)("i",{className:"mdi mdi-menu-"+(o.includes(a)?"down":"right")}),(0,e.jsx)("span",{children:a})]})},a),r&&o.includes(a)&&(0,e.jsx)(M,{node:n[a],level:l+1,onSelect:e=>t(`${a}.${e}`),selected:p})]})}))})},A=({className:n,isOpen:l,selected:t,position:s,items:o,onSelected:i,onClose:r})=>{const[c,p]=(0,a.useState)(""),[u,d]=(0,a.useState)(""),[m,f]=(0,a.useState)(o),[h,g]=(0,a.useState)({top:200});return(0,a.useEffect)((()=>{const e=a=>Object.keys(a).reduce(((n,l)=>{if("object"==typeof a[l]){if(!l)return n;if(0===Object.keys(a[l]).length)return n[l]="",n;a[l].type?n[l]=a[l].type:n[l]=e(a[l])}else n[l]=a[l];return n}),{});if(!o)return;const a=e(o);f(JSON.parse(JSON.stringify(a))),p("")}),[o]),(0,a.useEffect)((()=>{t&&p(t)}),[t]),(0,a.useEffect)((()=>{s&&g(s)}),[s]),(0,e.jsx)("div",{className:v()("picker",n),children:(0,e.jsx)(y,{title:"Picker",position:h,isOpen:l,onClose:()=>r(),children:(0,e.jsxs)("div",{children:[(0,e.jsx)(N,{className:"mb-3",placeholder:"Search",value:u,onChange:e=>d(e)}),(0,e.jsx)("div",{className:"tree",children:(0,e.jsx)(M,{node:(e=>{const a=n=>Object.keys(n).reduce(((l,t)=>{if(t.toLowerCase().includes(e.toLowerCase())&&(l[t]=n[t]),Array.isArray(n[t])){const a=n[t].filter((a=>"string"==typeof a&&a.toLowerCase().includes(e.toLowerCase())));a.length>0&&(l[t]=a)}if("object"==typeof n[t]&&null!==n[t]){const e=a(n[t]);Object.keys(e).length>0&&(l[t]=e)}return l}),{});return m?a(m):{}})(u),selected:c,onSelect:e=>{p(e)}})}),(0,e.jsxs)("div",{className:"d-flex justify-content-end mt-3",children:[(0,e.jsx)(P,{color:"secondary",className:"px-2",onClick:()=>r(),children:"Cancel"}),(0,e.jsx)(P,{className:"ms-3 px-2",disabled:!c,onClick:()=>{i(c),r()},children:"SELECT"})]})]})})})},L=({label:n,className:l,types:t,expression:s,disabled:o,constantsOptions:i,store:r,onChange:c,onBlur:p})=>{const[u,d]=(0,a.useState)([]),[m,v]=(0,a.useState)(t[0]),[y,f]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{v(s.type),f(s.value)}),[s]),(0,a.useEffect)((()=>{d(t.map((e=>({name:e,value:e}))))}),[t]),(0,e.jsxs)("div",{className:`expression-flow ${l||""}`,children:[(0,e.jsx)(j,{label:n,options:u,disabled:o||h,value:m,onChange:e=>{null==c||c({value:"",type:e}),null==p||p({value:"",type:e})}}),(0,e.jsxs)("div",{className:"d-flex align-items-center mt-2",children:["constant"===m?(0,e.jsx)(j,{className:"w-100",options:i||[],value:y,disabled:o||h,onChange:e=>{null==c||c({type:m,value:e}),null==p||p({type:m,value:e}),f(e)}}):(0,e.jsx)(N,{className:"w-100",value:y,onChange:e=>{null==c||c({type:m,value:e}),f(e)},disabled:o||h,onBlur:e=>null==p?void 0:p({type:m,value:e.target.value})}),["context","input","output","vars"].includes(m)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"ms-2",onClick:e=>{o||g(!0)},children:(0,e.jsx)("i",{className:y?"mdi mdi-database":"mdi mdi-database-outline"})}),(0,e.jsx)(A,{isOpen:h,items:r[m],onClose:()=>g(!1),selected:y,onSelected:e=>{null==c||c({type:m,value:e}),null==p||p({type:m,value:e}),f(e)}})]})]})]})},R=({mapping:n,mappingSchema:l,outerStore:t,readOnly:s,onChangeInParamMapping:o,onChangeOutParamMapping:i})=>{const[r,c]=(0,a.useState)((null==n?void 0:n.inParamMapping)||[]),[p,u]=(0,a.useState)((null==n?void 0:n.outParamMapping)||[]),d=["input","context","string","number","boolean",t.vars&&"vars"],m=[!t.vars&&"context","output",t.vars&&"vars"];(0,a.useEffect)((()=>{c((null==n?void 0:n.inParamMapping)||[])}),[null==n?void 0:n.inParamMapping]),(0,a.useEffect)((()=>{u((null==n?void 0:n.outParamMapping)||[])}),[null==n?void 0:n.outParamMapping]);const v=[{component:L,componentName:"Expression",key:"mapping",props:{label:"Assignment",types:d,store:t}}],y=[{component:L,componentName:"Expression",key:"mapping",props:{label:"Assignment",types:m,store:t}}];function f(e){return e&&e.mapping&&e.mapping.value&&("string"===e.mapping.type||""!==e.mapping.value)?"":"Mapping Not Assigned"}return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g,{disabled:s,emptyValues:{variable:{type:"input",value:""},mapping:{type:"string",value:""}},dialogTitle:"Assign To",getFieldLabel:e=>e.variable.value,fields:r,disabledFields:l.inParamMapping,fieldLabel:"Variable",collapsibleLabel:"IN VARIABLES MAPPING",isAddible:!1,dialogElements:v,onChange:e=>{c(e),o(e)},validate:f}),(0,e.jsx)(g,{disabled:s,emptyValues:{variable:{type:"output",value:""},mapping:{type:"context",value:""}},dialogTitle:"Assign To",fields:p,disabledFields:l.outParamMapping,fieldLabel:"Variable",getFieldLabel:e=>e.variable.value,collapsibleLabel:"OUT VARIABLES MAPPING",isAddible:!1,dialogElements:y,onChange:e=>{u(e),i(e)},validate:f})]})};let V;const $=V={inParamMapping:[],outParamMapping:[]};var D;let I;D={boolean:!0,datetime:!0,enum:!0,number:!0,dataType:!0,string:!0,constant:!0,any:!0},Object.keys(D);const F=I={quick:{modelKeys:{self:"qjson"}},flow:{modelKeys:{design:"flow-design",runtime:"flow-runtime"}},workflow:{modelKeys:{design:"workflow-design",runtime:"workflow-runtime"}},dataTypeEditor:{modelKeys:{single:"dataType"}},serviceEditor:{modelKeys:{single:"restService"}},soapEditor:{modelKeys:{single:"soapService"}},enum:{modelKeys:{single:"enum"}},constantEditor:{modelKeys:{single:"constant"}}};new Error("unimplemented for namedComponent"),new Error("unimplemented for json");const _={name:"humantask",panelLabel:"User Task",version:"0.8",inputs:[{name:"_"}],outputs:["_"],color:"#E91E63",icon:"mdi-account-card-outline",defaultProps:()=>({label:{type:"string",value:"User Task"},description:"User Task",taskName:{type:"string",value:"User Task"},procesStatus:"",taskStatus:"",forms:[],actions:[]}),editSection:l=>()=>{var t,s,o,i,r,c,p,u,m;const{NameDiv:v,DescDiv:y}=l.react.prop,[f,h]=(0,a.useState)([]),[b,x]=(0,a.useState)([]),T=null===(o=null===(s=null===(t=null==l?void 0:l.callbacks)||void 0===t?void 0:t.ui)||void 0===s?void 0:s.getRoles)||void 0===o?void 0:o.call(s),[P,M]=(0,a.useState)(l.propValues.swimlane),A=null===(c=null===(r=null===(i=null==l?void 0:l.callbacks)||void 0===i?void 0:i.ui)||void 0===r?void 0:r.getSwimlanes)||void 0===c?void 0:c.call(r),[L,V]=(0,a.useState)((D=O(l.propValues.actions,T))?((D||[]).forEach((e=>{e.props||(e.props={}),e.props.validation||(e.props.validation={type:"literal",value:""}),e.props.function||(e.props.function={id:"",type:"referenced",mapping:{inParamMapping:[],outParamMapping:[]}})})),D):[]);var D;const[I,_]=(0,a.useState)(O(l.propValues.forms,T)),[U,B]=(0,a.useState)((null===(p=l.propValues.taskName)||void 0===p?void 0:p.value)||""),[K,H]=(0,a.useState)(l.propValues.procesStatus||""),[q,J]=(0,a.useState)(l.propValues.sendTo||"swimlane"),[W,G]=(0,a.useState)(l.propValues.user||""),[Y,z]=(0,a.useState)(l.propValues.swimlane||""),[X,Z]=(0,a.useState)(!1),Q=f.map((e=>({name:`${e.name}`,value:e.ID}))),ee=b.map((e=>({name:`${e.name}`,value:e.ID}))),ae=null==T?void 0:T.map((e=>({name:`${e.name.value}`,value:e.id}))),ne=Object.keys(k).filter((e=>"start"!==e)).map((e=>({name:`${e}`,value:e}))),le=null==A?void 0:A.map((e=>({name:`${e.name.value}`,value:e.id}))),te=Object.entries(n).map((e=>({name:`${e[1]}`,value:`${e[0]}`})));if(!l.callbacks.ui)throw new Error("humantask can not execute on environments without UI");const se=l.callbacks.ui;(0,a.useEffect)((()=>{var e;B((null===(e=l.propValues.taskName)||void 0===e?void 0:e.value)||"")}),[null===(u=l.propValues.taskName)||void 0===u?void 0:u.value]),(0,a.useEffect)((()=>{H(l.propValues.procesStatus||"")}),[l.propValues.procesStatus]),(0,a.useEffect)((()=>{J(l.propValues.sendTo||"swimlane"),"swimlane"===l.propValues.sendTo?(G(""),z(l.propValues.swimlane||"")):G(l.propValues.user||"")}),[l.propValues.sendTo,l.propValues.user,l.propValues.swimlane]),(0,a.useEffect)((()=>{(async()=>{h(await se.getModels("qjson"))})()}),[]),(0,a.useEffect)((()=>{(async()=>{x(await se.getModels("flow"))})()}),[]);const oe=[{component:j,componentName:"Select",key:"id",props:{label:"Form",types:l.propValues.forms.map((e=>e.id)),options:Q}},{component:E,componentName:"MultiSelect",key:"roles",props:{label:"Roles",options:ae}},{component:w,componentName:"Checkbox",key:"readonly",props:{label:"Readonly",className:"mt-3"}}],ie=[{component:j,componentName:"Select",key:"actionType",props:{label:"Action Type",types:k,options:ne,className:"mt-3"}},{component:j,componentName:"Select",key:"props.function.id",isRendered:e=>"function"===(null==e?void 0:e.actionType)||!1,props:{label:"Function To Run",options:ee,className:"mt-3"}},{component:R,componentName:"Mapping",key:"props.function.mapping",isRendered:e=>"function"===(null==e?void 0:e.actionType)||!1,props:{mappingSchema:structuredClone($),outerStore:l.callbacks.nestedStore,className:"mt-3"}},{component:N,componentName:"Input",key:"customType",isRendered:e=>["start","complete"].includes(null==e?void 0:e.actionType)||!1,props:{label:"Custom Type",className:"mt-3"}},{component:N,componentName:"Input",key:"label",props:{label:"Label",className:"mt-3"}},{component:E,componentName:"MultiSelect",key:"roles",props:{label:"Roles",className:"mt-3",options:ae}},{component:E,componentName:"MultiSelect",key:"props.uniqueKeys",isRendered:e=>["start","claim","complete"].includes(null==e?void 0:e.actionType)||!1,props:{label:"Unique Keys",className:"mt-3",options:[{name:"Maker 1",value:"maker1"},{name:"Maker 2",value:"maker2"},{name:"Checker 1",value:"checker1"},{name:"Checker 2",value:"checker2"},{name:"Approver 1",value:"approver1"},{name:"Approver 2",value:"approver2"}]}},{component:w,componentName:"Checkbox",key:"props.userBound",isRendered:e=>!S.includes(null==e?void 0:e.actionType)||!1,props:{label:"User Bound",className:"mt-3"}},{component:N,componentName:"Input",key:"props.validation.value",props:{label:"Visibility Expression (T/F)",className:"mt-3"}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(d,{label:"USER TASK NAME",children:[(0,e.jsx)(N,{disabled:l.callbacks.readOnly,className:"mx-3",label:"Label",value:(null===(m=l.propValues.label)||void 0===m?void 0:m.value)||"",onChange:e=>l.callbacks.setProp("label",{type:"string",value:e})}),(0,e.jsx)(N,{disabled:l.callbacks.readOnly,className:"mx-3",label:"Task Name",value:U,onChange:e=>{let a=e.replace(/[^a-zA-Z0-9]+/g,"");B(a),l.callbacks.setProp("taskName",{type:"string",value:a})}}),(0,e.jsx)(j,{disabled:l.callbacks.readOnly,className:"mx-3",label:"Process Status",options:te,value:K,onChange:e=>{H(e),l.callbacks.setProp("procesStatus",e)}})]}),(0,e.jsxs)(d,{label:"PROPERTIES",children:[(0,e.jsx)(j,{disabled:l.callbacks.readOnly,label:"Send To",className:"mx-3",options:[{name:"Swimlane",value:"swimlane"},{name:"User",value:"user"}],value:q||"swimlane",onChange:e=>{J(e),l.callbacks.setProp("sendTo",e)}}),"user"===q&&(0,e.jsx)(N,{disabled:l.callbacks.readOnly,label:"User",className:"mx-3",value:W,onChange:e=>{G(e),l.callbacks.setProp("user",e)}}),"swimlane"===q&&(0,e.jsx)(j,{disabled:l.callbacks.readOnly,label:"Swimlane",className:"mx-3",options:le||[],value:P||"",onChange:e=>{M(e),l.callbacks.setProp("swimlane",e)}})]}),(0,e.jsx)(C,{readOnly:l.callbacks.readOnly,priority:l.propValues.priority,onChangePriority:e=>{l.callbacks.setProp("priority",e)},sla:l.propValues.sla,onChangeSLA:e=>{l.callbacks.setProp("sla",e)}}),(0,e.jsx)(g,{disabled:l.callbacks.readOnly,fields:I,dialogTitle:"Form",collapsibleLabel:"FORMS",fieldLabel:"Form",getFieldLabel:e=>{var a;return(null===(a=f.find((a=>a.ID==e.id)))||void 0===a?void 0:a.name)||""},dialogElements:oe,emptyValues:{id:"",roles:[],readonly:!1},createItemLabel:"Add Forms",onChange:e=>{_(e),l.callbacks.setProp("forms",e)}}),(0,e.jsx)(g,{disabled:l.callbacks.readOnly,fields:L,dialogTitle:"Action",collapsibleLabel:"ACTIONS",fieldLabel:"Action",getFieldLabel:e=>e.actionType?e.customType?`${e.actionType} - ${e.customType}`:`${e.actionType}`:"",dialogElements:ie,emptyValues:{actionType:"claim",customType:"",label:"",roles:[],props:{uniqueKeys:[],userBound:!1,validation:{type:"literal",value:""},function:{id:"",type:"referenced",mapping:{inParamMapping:[],outParamMapping:[]}}}},createItemLabel:"Add Actions",onChange:e=>(async e=>{var a,n,t;for(let s of e)if(s.props||(s.props={}),s.props.userBound=!S.includes(s.actionType)&&(null===(a=s.props)||void 0===a?void 0:a.userBound),s.props.function&&s.props.function.mapping&&"function"===s.actionType||(s.props.function={id:"",type:"referenced",mapping:{inParamMapping:[],outParamMapping:[]}}),"function"===s.actionType&&"referenced"==s.props.function.type){const e=b.find((e=>{var a;return e.ID===(null===(a=s.props)||void 0===a?void 0:a.function).id}));if(e&&s.customType!=e.name){s.customType=(null==e?void 0:e.name)||"";const a=await(null===(t=null===(n=l.callbacks.ui)||void 0===n?void 0:n.getModelBody)||void 0===t?void 0:t.call(n,e.ID,F.flow.modelKeys.runtime));s.props.function.mapping.inParamMapping=Object.values(a.store.input).map((e=>({variable:{type:"input",value:e._name},mapping:{type:"string",value:""}}))),s.props.function.mapping.outParamMapping=Object.values(a.store.output).map((e=>({variable:{type:"output",value:e._name},mapping:{type:"context",value:""}})))}}V(e),l.callbacks.setProp("actions",e)})(e)})]})}}})(),s})()));